<!doctype html>
<meta charset="utf-8">
<title>Coot Workshop</title>
<meta name="author" content="Paul Bond">
<meta name="description" content="Coot Workshop for the Protein Crystallography Summer School 2019">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" href="css/skeleton.css">
<link rel="stylesheet" href="css/custom.css">

<div class="container">

  <h1>Coot Workshop</h1>
  <h4>Protein Crystallography Summer School 2019</h4>
  <p>
    <a href="https://synergy.st-andrews.ac.uk/proteincrystallography">https://synergy.st-andrews.ac.uk/proteincrystallography</a><br>
    1st to 7th September 2019 (<a href="https://synergy.st-andrews.ac.uk/proteincrystallography/files/2019/05/Timetable-Summer-School-2019-for-Website.pdf">Programme</a>)<br>
    University of York
  </p>

  <ol class="no-print">
    <li><a href="#1">Introduction</a></li>
    <li><a href="#2">Starting</a></li>
    <li><a href="#3">Viewing</a></li>
    <li><a href="#4">Fixing the protein</a></li>
    <li><a href="#5">Adding solvent</a></li>
    <li><a href="#6">Building a peptide</a></li>
    <li><a href="#7">Adding a ligand</a></li>
  </ol>

  <h5 id="1">1. Introduction</h5>
  <p>
    <i>Coot</i> is a program for macromolecular model building,
    model completion and validation
    (<a href="https://doi.org/10.1107/S0907444910007493">Emsley <i>et al.</i> 2010</a>).
    This workshop will give step-by-step instructions on
    how to use <i>Coot</i> to complete a molecular replacement (MR) solution.
    The structure we are trying to build is
    <a href="https://www.ebi.ac.uk/pdbe/entry/pdb/5eg2">5EG2</a>,
    a human SET7/9 mutant in complex with S-adenosyl-l-homocysteine (SAH) and
    a 10 residue transcription initiation factor
    (<a href="https://doi.org/10.1021/acschembio.5b00852">Fick <i>et al.</i> 2016</a>).
    The data extend to 1.55 &angst; resolution and
    the A chain is small with only 262 residues.
  </p>
  <p>
    As a homology model, we have chosen
    <a href="https://www.ebi.ac.uk/pdbe/entry/pdb/1n6a">1N6A</a>.
    This is an older selenomethionine derivative of human SET7/9
    solved at 1.7 &angst; resolution
    (<a href="https://doi.org/10.1093/emboj/cdg025">Kwon <i>et al.</i> 2003</a>).
    The model was processed using <i>phaser.sculptor</i>,
    which trims unaligned regions using a sequence alignment
    and truncates side chains that differ between the model and target.
    Pruning the MR model was not needed to find a solution in this case
    as it is so similar, but in general it is good practice.
    MR was done using <i>phaser</i>
    through the <i>CCP4i2</i> Basic Molecular Replacement task.
    This was followed by <i>csymmatch</i>
    to move the MR solution to the same origin as the deposited structure
    and finally refinement using <i>REFMAC</i>.
    The following files produced by <i>REFMAC</i> are needed for the workshop:
  </p>
  <ul>
    <li>
      <a href="data/refined_model.mtz">refined_model.mtz</a>
      - reflection data in MTZ format
    </li>
    <li>
      <a href="data/refined_model.pdb">refined_model.pdb</a>
      - coordinates in PDB format
    </li>
  </ul>

  <h5 id="2">2. Starting</h5>
  <p>
    Type <code>coot</code> on the command line.
    The <i>Coot</i> window should appear.
    For this to work, the coot executable should be in your path.
    If it is not then you need to source one of the CCP4 setup scripts:
    <pre><code>source ccp4-7.0/bin/ccp4.setup-csh  # if shell is csh/tcsh<br>source ccp4-7.0/bin/ccp4.setup-sh   # if shell is bash</code></pre>
  </p>
  <p>
    The <i>Coot</i> window should look something like this:
  </p>
  <img src="img/window.png" alt="Coot Window">
  <p>
    At the top of the screen is the menu bar with File, Edit, Calculate etc.
    Below this is the main toolbar with a button to open the Display Manager.
    Buttons on the main toolbar can be customised
    by right clicking on the empty space.
    On the right is the refinement toolbar
    with the most widely used model building tools.
    At the bottom of the window is the status bar,
    which is used to display messages.
  </p>
  <p>
    Files that you want to open in <i>Coot</i>
    can also be passed as command line arguments:
    <pre><code>coot refined_model.pdb refined_mode.mtz</code></pre>
    PDB and mmCIF format coordinate files can be opened in this way,
    as well as MTZ files from programs such as <i>REFMAC</i>
    where the column labels for the 2mFo-DFc and mFo-DFc maps are known.
    Instead, we will open our files manually.
    Choose <code>File / Open Coordinates</code>
    (you can also click the folder icon in the main toolbar).
    A file browser will appear.
    From this you can select a coordinate file,
    as well choose how to recentre the view and the new molecule.
    Select <code>refined_model.pdb</code> and click <code>Open</code>.
  </p>
  <p>
    A window will appear asking you to fix nomenclature errors.
    This is a common occurence when opening coordinates and is usually because
    there is an atom naming convention for symmetrical residues,
    e.g. which way round CD1 and CD2 are in PHE, that most programs ignore.
    Click <code>Yes</code> to fix them.
  </p>
  <p>
    Now we will open the 2mFo-DFc and mFo-DFc maps.
    Going to <code>File / Auto Open MTZ</code>
    is equivalent to passing the MTZ on the command line
    and will open both maps if it can work out which columns to use.
    We will open the maps one at a time.
    Choose <code>File / Open MTZ, mmCIF, fcf or phs</code>
    to open the file browser.
    Select <code>refined_model.mtz</code> and click <code>Open</code>.
    The following window should appear:
  </p>
  <img src="img/mtz_cols.png" alt="Column Label Assignment">
  <p>
    This window allows you to select
    which amplitude and phase columns to use for the new map.
    Sensible defaults have been chosen for the 2mFo-DFc map.
    In this case there is no need use weights
    because the FWT,PHWT columns are already weighted.
    If you click the <code>Expert Mode?</code> button
    you can also choose resolution limits to truncate the data.
    Click <code>OK</code> to open the 2mFo-DFc map.
  </p>
  <p>
    Now we will open the mFo-DFc map.
    Choose <code>File / Open MTZ, mmCIF, fcf or phs</code> again
    and open <code>refined_model.mtz</code>.
    Change the <code>Amplitudes</code> column to <code>DELFWT</code>
    and the <code>Phases</code> column to <code>PHDELWT</code>.
    The <code>Is a Difference Map</code> checkbox
    needs to be checked (should happen automatically)
    so that <i>Coot</i> will treat this as a difference map.
    Click <code>OK</code>.
  </p>
  <p>
    The maps should be visible as a sphere in the centre of the screen.
    By default, the 2mFo-DFc is coloured blue
    and the mFo-DFc (difference) map is coloured
    green for positive density and red for negative density.
  </p>
  <img src="img/maps.png" alt="2mFo-DFc and mFo-DFc Maps">

  <h5 id="3">3. Viewing</h5>
  <p>
    The following controls are used to change the view:
  </p>
  <table>
    <thead>
      <tr><th>Action</th><th>Result</th></tr>
    </thead>
    <tbody>
      <tr><td>Left-mouse drag</td><td>Rotate view</td></tr>
      <tr><td>Ctrl left-mouse drag</td><td>Translate view</td></tr>
      <tr><td>Right-mouse drag</td><td>Zoom</td></tr>
      <tr><td>Ctrl right-mouse drag</td><td>Adjust clipping</td></tr>
      <tr><td>Middle-mouse click</td><td>Centre on atom</td></tr>
    </tbody>
  </table>
  <p>
    By default, the rotation is done
    using a virtual trackball with a spherical surface.
    It depends not only on the direction you are dragging
    but also where in the view the mouse pointer is.
    If this feels strange you can try changing it
    by going to <code>Edit / Preferences</code>,
    selecting <code>General</code> on the left
    and choosing the <code>HID</code> tab.
    The <code>Flat</code> option will change the rotation
    so that only the direction of dragging matters.
  </p>
  <img src="img/trackball.png" alt="Virtual Trackball">
  <p>
    Open <code>Display Manager</code> from the main toolbar.
    This shows lists of all the molecules and maps currently open.
    You can toggle whether individual molecules and maps are displayed.
  </p>
  <img src="img/display_manager.png" alt="Display Manager">
  <p>
    The default representation for molecules is
    <code>Bonds (Colour by Atom)</code>,
    which is a good representation for model building.
    However, if we want to look at larger scale features of the model
    the <code>C-alphas/Backbone</code> representation is useful.
    For now, un-display both maps
    and change the molecule representation to <code>Jones' Rainbow</code>.
    This is a variation of the C-alpha representation
    where the chain is coloured
    from blue at the N-terminus to red at the C-terminus.
    The dotted lines at the C-terminus
    show us that there are missing residues there.
  </p>
  <img src="img/rainbow.png" alt="Jones' Rainbow">
  <p>
    When checking if a molecular replacement solution is correct,
    it is useful to see whether the packing of molecules
    looks reasonable for a crystal.
    To control the displaying of symmetry equivalents
    go to <code>Draw / Cell & Symmetry</code>.
    The following window should appear:
  </p>
  <img src="img/symmetry.png" alt="Cell & Symmetry">
  <p>
    Turn the <code>Master Switch</code> to <code>Symmetry On</code>
    then click the <code>Symmetry by Molecule</code> button
    to open another window.
    In the new window change the Display Options
    for Molecule 0 (the only molecule)
    to <code>Display as CAs</code> and click <code>OK</code>.
    Increase the <code>Symmetry Atom Display Radius</code>
    to <code>80</code> &angst;,
    change <code>Show Unit Cells?</code> to <code>Yes</code>
    and click <code>OK</code>.
    The spacegroup is P 3<sub>2</sub> 2 1.
    If you rotate the view to look along the C axis of the cell
    you can see the threefold rotation
    and long triangular channels that run through the crystal.
    Also, importantly, the molecule has close contacts with its neighbours
    that are necessary for crystal formation.
    Below, the image on the left shows our good MR solution
    and the image on the right shows a bad MR solution
    without proper crystal packing.
  </p>
  <div class="row">
    <div class="one-half column"><img src="img/packing_good.png" alt="Good Packing"></div>
    <div class="one-half column"><img src="img/packing_bad.png" alt="Bad Packing"></div>
  </div>
  <ol>
    <li>Map display</li>
    <li>Map scrolling</li>
    <li>Go to atom</li>
  </ol>

  <h5 id="4">4. Fixing the protein</h5>
  <ol>
    <li>Renumber residue range</li>
    <li>Touch on validation (density fit only)</li>
    <li>Deleting</li>
    <li>Mutating</li>
    <li>Rotamers</li>
    <li>Real space refinement</li>
    <li>Adding terminal residues</li>
  </ol>

  <h5 id="5">5. Adding solvent</h5>
  <ol>
    <li>Adding solvent molecules</li>
    <li>Auto find waters</li>
    <li>Checking waters</li>
    <li>Manually add waters</li>
  </ol>

  <h5 id="6">6. Building a peptide</h5>
  <ol>
    <li>Skeleton map</li>
    <li>CA Baton mode</li>
    <li>Mutate resiude range</li>
  </ol>

  <h5 id="7">7. Adding a ligand</h5>
  <ol>
    <li>Only if Rob isn't doing this part</li>
  </ol>

  <p>
    Extra?
    Opening Coot via i2? Competition to see who gets the lowest R-free?
    Trying other online tutorials?
  </p>

  <hr>
  <p>
    Paul Bond,
    University of York,
    <a href="mailto:paul.bond@york.ac.uk">paul.bond@york.ac.uk</a>
  </p>
</div>
