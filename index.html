<!doctype html>
<meta charset="utf-8">
<title>Coot Workshop</title>
<meta name="author" content="Paul Bond">
<meta name="description" content="Coot Workshop for the Protein Crystallography Summer School 2019">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" href="css/skeleton.css">
<link rel="stylesheet" href="css/custom.css">

<div class="container">

  <h1>Coot Workshop</h1>
  <h4>Protein Crystallography Summer School 2019</h4>
  <p>
    <a href="https://synergy.st-andrews.ac.uk/proteincrystallography">https://synergy.st-andrews.ac.uk/proteincrystallography</a><br>
    1st to 7th September 2019 (<a href="https://synergy.st-andrews.ac.uk/proteincrystallography/files/2019/05/Timetable-Summer-School-2019-for-Website.pdf">Programme</a>)<br>
    University of York
  </p>

  <ol class="no-print">
    <li><a href="#1">Introduction</a></li>
    <li><a href="#2">Starting</a>
      <ol>
        <li><a href="#2.1">Starting Coot</a></li>
        <li><a href="#2.2">Opening Files</a></li>
      </ol>
    </li>
    <li><a href="#3">Viewing</a>
      <ol>
        <li><a href="#3.1">Controls</a></li>
        <li><a href="#3.2">Virtual Trackball</a></li>
        <li><a href="#3.3">Display Manager</a></li>
        <li><a href="#3.4">Molecule Representations</a></li>
        <li><a href="#3.5">Symmetry & Packing</a></li>
        <li><a href="#3.6">Solvent Boundaries</a></li>
        <li><a href="#3.7">Map Contouring</a></li>
        <li><a href="#3.8">Go To Atom</a></li>
      </ol>
    </li>
    <li><a href="#4">Fixing the protein</a>
      <ol>
        <li><a href="#4.1">Renumber Residue Range</a></li>
        <li><a href="#4.2">Density Fit</a></li>
        <li><a href="#4.3">Deleting</a></li>
        <li><a href="#4.4">Mutating</a></li>
        <li><a href="#4.5">Rotamers</a></li>
        <li><a href="#4.6">Real Space Refinement</a></li>
        <li><a href="#4.7">Adding Terminal Residues</a></li>
      </ol>
    </li>
    <li><a href="#5">Adding solvent</a></li>
    <li><a href="#6">Building a peptide</a></li>
    <li><a href="#7">Adding a ligand</a></li>
  </ol>

  <h3 id="1">1. Introduction</h3>

  <p>
    <i>Coot</i> is a program for macromolecular model building,
    model completion and validation
    (<a href="https://doi.org/10.1107/S0907444910007493">Emsley <i>et al.</i> 2010</a>).
    This workshop will give step-by-step instructions on
    how to use <i>Coot</i> to complete a molecular replacement (MR) solution.
    The structure we are trying to build is
    <a href="https://www.ebi.ac.uk/pdbe/entry/pdb/5eg2">5EG2</a>,
    a human SET7/9 mutant in complex with S-adenosyl-l-homocysteine (SAH) and
    a 10 residue transcription initiation factor
    (<a href="https://doi.org/10.1021/acschembio.5b00852">Fick <i>et al.</i> 2016</a>).
    The data extend to 1.55 &angst; resolution and
    the A chain is small with only 262 residues.
  </p>
  <p>
    As a homology model, we have chosen
    <a href="https://www.ebi.ac.uk/pdbe/entry/pdb/1n6a">1N6A</a>.
    This is an older selenomethionine derivative of human SET7/9
    solved at 1.7 &angst; resolution
    (<a href="https://doi.org/10.1093/emboj/cdg025">Kwon <i>et al.</i> 2003</a>).
    The model was processed using <i>phaser.sculptor</i>,
    which trims unaligned regions using a sequence alignment
    and truncates side chains that differ between the model and target.
    Pruning the MR model was not needed to find a solution in this case
    as it is so similar, but in general it is good practice.
    MR was done using <i>phaser</i>
    through the <i>CCP4i2</i> Basic Molecular Replacement task.
    This was followed by <i>csymmatch</i>
    to move the MR solution to the same origin as the deposited structure
    and finally refinement using <i>REFMAC</i>.
    The following files produced by <i>REFMAC</i> are needed for the workshop:
  </p>
  <ul>
    <li>
      <a href="data/refined_model.mtz">refined_model.mtz</a>
      - reflection data in MTZ format
    </li>
    <li>
      <a href="data/refined_model.pdb">refined_model.pdb</a>
      - coordinates in PDB format
    </li>
  </ul>

  <h3 id="2">2. Starting</h3>

  <h6 id="2.1">2.1. Starting Coot</h6>
  <p>
    Type <code>coot</code> on the command line.
    The <i>Coot</i> window should appear.
    For this to work, the coot executable should be in your path.
    If it is not then you need to source one of the CCP4 setup scripts:
    <pre><code>source ccp4-7.0/bin/ccp4.setup-csh  # if shell is csh/tcsh<br>source ccp4-7.0/bin/ccp4.setup-sh   # if shell is bash</code></pre>
  </p>
  <p>
    The <i>Coot</i> window should look something like this:
  </p>
  <img src="img/window.png" alt="Coot Window">
  <p>
    At the top of the screen is the menu bar with File, Edit, Calculate etc.
    Below this is the main toolbar with a button to open the Display Manager.
    Buttons on the main toolbar can be customised
    by right clicking on the empty space.
    On the right is the refinement toolbar
    with the most widely used model building tools.
    At the bottom of the window is the status bar,
    which is used to display messages.
  </p>

  <h6 id="2.2">2.2. Opening Files</h6>
  <p>
    Files that you want to open in <i>Coot</i>
    can also be passed as command line arguments:
    <pre><code>coot refined_model.pdb refined_mode.mtz</code></pre>
    PDB and mmCIF format coordinate files can be opened in this way,
    as well as MTZ files from programs such as <i>REFMAC</i>
    where the column labels for the 2mFo-DFc and mFo-DFc maps are known.
    Instead, we will open our files manually.
    Choose <code>File / Open Coordinates</code>
    (you can also click the folder icon in the main toolbar).
    A file browser will appear.
    From this you can select a coordinate file,
    as well choose how to recentre the view and the new molecule.
    Select <code>refined_model.pdb</code> and click <code>Open</code>.
  </p>
  <p>
    A window will appear asking you to fix nomenclature errors.
    This is a common occurrence when opening coordinates and is usually because
    there is an atom naming convention for symmetrical residues,
    e.g. which way round CD1 and CD2 are in PHE, that most programs ignore.
    Click <code>Yes</code> to fix them.
  </p>
  <p>
    Now we will open the 2mFo-DFc and mFo-DFc maps.
    Going to <code>File / Auto Open MTZ</code>
    is equivalent to passing the MTZ on the command line
    and will open both maps if it can work out which columns to use.
    We will open the maps one at a time.
    Choose <code>File / Open MTZ, mmCIF, fcf or phs</code>
    to open the file browser.
    Select <code>refined_model.mtz</code> and click <code>Open</code>.
    The following window should appear:
  </p>
  <img src="img/mtz_cols.png" alt="Column Label Assignment">
  <p>
    This window allows you to select
    which amplitude and phase columns to use for the new map.
    Sensible defaults have been chosen for the 2mFo-DFc map.
    In this case there is no need use weights
    because the FWT,PHWT columns are already weighted.
    If you click the <code>Expert Mode?</code> button
    you can also choose resolution limits to truncate the data.
    Click <code>OK</code> to open the 2mFo-DFc map.
  </p>
  <p>
    Now we will open the mFo-DFc map.
    Choose <code>File / Open MTZ, mmCIF, fcf or phs</code> again
    and open <code>refined_model.mtz</code>.
    Change the <code>Amplitudes</code> column to <code>DELFWT</code>
    and the <code>Phases</code> column to <code>PHDELWT</code>.
    The <code>Is a Difference Map</code> checkbox
    needs to be checked (should happen automatically)
    so that <i>Coot</i> will treat this as a difference map.
    Click <code>OK</code>.
  </p>
  <p>
    The maps should be visible as a sphere in the centre of the screen.
    By default, the 2mFo-DFc is coloured blue
    and the mFo-DFc (difference) map is coloured
    green for positive density (where parts of the model are missing)
    and red for negative density (where the model is in the wrong place).
  </p>
  <img src="img/maps.png" alt="2mFo-DFc and mFo-DFc Maps">

  <h3 id="3">3. Viewing</h3>

  <h6 id="3.1">3.1. Controls</h6>
  <p>
    The following controls are used to change the view:
  </p>
  <table>
    <thead>
      <tr><th>Action</th><th>Result</th></tr>
    </thead>
    <tbody>
      <tr><td>Left-mouse drag</td><td>Rotate view</td></tr>
      <tr><td>Ctrl left-mouse drag</td><td>Translate view</td></tr>
      <tr><td>Right-mouse drag</td><td>Zoom</td></tr>
      <tr><td>Ctrl right-mouse drag</td><td>Adjust clipping</td></tr>
      <tr><td>Middle-mouse click</td><td>Centre on atom</td></tr>
    </tbody>
  </table>

  <h6 id="3.2">3.2. Virtual Trackball</h6>
  <p>
    By default, the rotation is done
    using a virtual trackball with a spherical surface.
    It depends not only on the direction you are dragging
    but also where in the view the mouse pointer is.
    If this feels strange you can try changing it
    by going to <code>Edit / Preferences</code>,
    selecting <code>General</code> on the left
    and choosing the <code>HID</code> tab.
    The <code>Flat</code> option will change the rotation
    so that only the direction of dragging matters.
  </p>
  <img src="img/trackball.png" alt="Virtual Trackball">

  <h6 id="3.3">3.3. Display Manager</h6>
  <p>
    Open <code>Display Manager</code> from the main toolbar.
    This shows lists of all the molecules and maps currently open.
    You can toggle whether individual molecules and maps are displayed
    and delete them if they are no longer needed.
    You can also change map properties,
    such as display style and contour levels,
    and molecule representations.
  </p>
  <img src="img/display_manager.png" alt="Display Manager">

  <h6 id="3.4">3.4. Molecule Representations</h6>
  <p>
    The default representation for molecules is
    <code>Bonds (Colour by Atom)</code>,
    which is a good representation for model building.
    However, if we want to look at larger scale features of the model
    the <code>C-alphas/Backbone</code> representation is useful.
    For now, un-display both maps
    and change the molecule representation to <code>Jones' Rainbow</code>.
    This is a variation of the C-alpha representation
    where the chain is coloured
    from blue at the N-terminus to red at the C-terminus.
    The dotted lines at the C-terminus
    show us that there are missing residues there.
  </p>
  <img src="img/rainbow.png" alt="Jones' Rainbow">

  <h6 id="3.5">3.5. Symmetry & Packing</h6>
  <p>
    When checking if a molecular replacement solution is correct,
    it is useful to see whether the packing of molecules
    looks reasonable for a crystal.
    To control the displaying of symmetry equivalents
    go to <code>Draw / Cell & Symmetry</code>.
    The following window should appear:
  </p>
  <img src="img/symmetry.png" alt="Cell & Symmetry">
  <p>
    Turn the <code>Master Switch</code> to <code>Symmetry On</code>
    then click the <code>Symmetry by Molecule</code> button
    to open another window.
    In the new window change the Display Options
    for Molecule 0 (the only molecule)
    to <code>Display as CAs</code> and click <code>OK</code>.
    Increase the <code>Symmetry Atom Display Radius</code>
    to <code>80</code> &angst;,
    change <code>Show Unit Cells?</code> to <code>Yes</code>
    and click <code>OK</code>.
    The spacegroup is P 3<sub>2</sub> 2 1.
    If you rotate the view to look along the C axis of the cell
    you can see the threefold rotation
    and long triangular channels that run through the crystal.
    Also, importantly, the molecule has close contacts with its neighbours
    that are necessary for crystal formation.
    Below, the image on the left shows our correct MR solution
    and the image on the right shows an incorrect MR solution
    without proper crystal packing.
  </p>
  <div class="row">
    <div class="one-half column"><img src="img/packing_good.png" alt="Good Packing"></div>
    <div class="one-half column"><img src="img/packing_bad.png" alt="Bad Packing"></div>
  </div>

  <h6 id="3.6">3.6. Solvent Boundaries</h6>
  <p>
    Another way to tell whether an MR solution is correct
    is by looking at the density.
    Go back to <code>Draw / Cell & Symmetry</code>
    and change <code>Display as CAs</code> to <code>Display Sphere</code>
    in the <code>Symmetry by Molecule</code> window.
    Also reduce <code>Symmetry Atom Display Radius</code>
    to <code>13</code> &angst;,
    change <code>Show Unit Cells?</code> to <code>No</code>
    and click <code>OK</code>.
    In the <code>Display Manager</code>,
    change the molecule representation to <code>Bonds (Colour by Atom)</code>
    and display both maps.
    If you move around the edge of the molecule
    the density should show a clear protein/solvent boundary.
    This won't be the case for a bad MR solution
    as the solvent will have lots of noise.
    The images below show solvent boundaries
    for the correct and incorrect solutions.
  </p>
  <div class="row">
    <div class="one-half column"><img src="img/boundary_good.png" alt="Good Solvent Boundary"></div>
    <div class="one-half column"><img src="img/boundary_bad.png" alt="Bad Solvent Boundary"></div>
  </div>

  <h6 id="3.7">3.7. Map Contouring</h6>
  <p>
    The maps can be contoured at different levels using the mouse scroll wheel
    or <code>+</code> and <code>-</code> on the keyboard.
    Density levels are specified either
    as absolute values (e/&angst;<sup>3</sup>)
    or as RMSD values.
    <i>Coot</i> will try to pick sensible defaults on opening,
    e.g. 0.41 e/&angst;<sup>3</sup> (1.5 RMSD) for our 2mFo-DFc map
    and 0.39 e/&angst;<sub>3</sub> (2.98 RMSD) for our mFo-DFc map.
    One click will change the contour level by 0.1 RMSD.
    Map properties can be edited globally at <code>Edit / Map Parameters</code>
    and for individual maps via the <code>Display Manager</code>.
    It is common to use RMSD when talking about map levels
    but keep in mind that, as the model improves,
    features in the difference map will start to disappear
    so the same level RMSD will display weaker features and more noise.
  </p>

  <h6 id="3.8">3.8. Go To Atom</h6>
  <p>
    A quick way to move about in Coot is to use the Go To Atom window.
    This can be accessed through <code>Draw / Go To Atom</code>,
    pressing <code>F6</code> on the keyboard
    or clicking the <img src="icons/go-to-atom.svg" class="icon"> icon
    in the main toolbar.
  </p>
  <img src="img/go_to_atom.png" alt="Go To Atom">
  <p>
    An atom can be selected using text boxes in the top left
    or the lists at the bottom of the window.
    Clicking <code>Apply</code> will move the view to the selected atom.
    This window can also be used to skip through residues using the
    <code>Next Residue</code> and <code>Previous Residue</code> buttons,
    although it is much quicker to use <code>Space</code> (for next residue)
    and <code>Shift</code><code>Space</code> (for previous residue)
    on the keyboard.
    Go to Glu72, which has its side chain in the wrong conformation.
    The clear density for the correct side chain position
    (where there is no model)
    is another good indicator that the MR solution is correct.
  </p>
  <p>
    There is also a quicker method
    of going to a specific residue using the keyboard.
    Press <code>Ctrl</code><code>G</code>
    and a text box should appear at the bottom left of the window.
    Type <code>161</code> and press <code>Enter</code> to go to residue 161.
    If the molecule has multiple chains
    you can prefix the residue number by the chain label.
  </p>

  <h3 id="4">4. Fixing the protein</h3>

  <h6 id="4.1">4.1. Renumber Residue Range</h6>
  <p>
    When preparing the molecular replacement model,
    the residues were numbered so that they start from 1
    at the N-terminus of the crystallised construct
    instead of the N-terminus of the full length protein.
    Residue 161 is actually the mutated N265A
    so we need to renumber the residues to make them match up.
    Go to <code>Edit / Renumber Residues</code>
    to get the following window:
  </p>
  <img src="img/renumber.png" alt="Renumber Residues">
  <p>
    We want to renumber all residues in our chain
    so change the <code>Start Residue</code> to <code>N-terminus</code>
    and the <code>End Residue</code> to <code>C-terminus</code>.
    Residue 161 needs to become 265
    so <code>Apply Offset</code> should be <code>104</code>.
    After clicking <code>Apply</code> you should see the updated atom label.
  </p>

  <h6 id="4.2">4.2. Density Fit Analysis</h6>
  <p>
    This workshop will not go too much into validation
    as it will be covered in other sessions,
    but we will briefly go through density fit analysis
    as it is very useful for getting a quick overview of a model.
    The density fit of a residue is measured using
    the average electron density level at the atom centres.
    Before opening the graphs, go to
    <code>Extensions / Settings / Set Density Fit Graph Weight</code>
    and change the scale value to <code>0.8</code>.
    Then open the analysis window by choosing
    <code>Validate / Density fit analysis</code>
    and picking the molecule.
  </p>
  <img src="img/density_fit.png" alt="Density Fit Analysis">
  <p>
    A window like the one above should appear.
    It shows a graph of residue number against density fit for each chain.
    Residues with good density fit values are small and green,
    and bad density fit values are large and red.
    If all residues are showing as green or red
    then the scaling should be adjusted as we did earlier.
    In this case we can see some residues with poor fit to density,
    mainly at the N and C termini.
    Click on the bar for His116 at the N-terminus to move the view there.
  </p>

  <h6 id="4.3">4.3. Deleting</h6>
  <p>
    Because the density for His116 is not very good
    we may want to delete this residue.
    The delete button can be found at the bottom of the refinement toolbar.
    If you are unsure which buttons correspond to which functions
    you can add text via <code>Edit / Preferences</code>.
    In the <code>Refinement Toolbar</code> tab
    of the <code>General</code> section,
    change the <code>Toolbar Style</code>
    from <code>Icons only</code> to <code>Icons and Text</code>.
    Click the <code>Delete</code> button and the following window should appear:
  </p>
  <img src="img/delete.png" alt="Delete">
  <p>
    Now click on one of the atoms in His116 to delete the residue close.
    Individual atoms (or side chains) can be deleted in
    this way by selecting this option in the window before clicking.
    You can check <code>Keep Delete Active</code> to keep the delete window open
    so that multiple residues can be deleted.
    If the residues are sequential
    it might be easier to use <code>Delete Zone</code>.
    In this case you need to click twice:
    once on the first residue to be deleted and once on the last.
  </p>

  <h6 id="4.4">4.4. Mutating</h6>
  <p>
    All of the residues in this structure are the correct type
    so do not need mutating.
    However, quite a few of the residues do not have complete side chains
    and the mutate function will work to rebuild them.
    Go to Met139 and see that the side chain is not complete.
    There is even a loose atom claiming to be the CE atom.
    It must have been left there during model preparation
    and this is the position it ended up in after refinement.
    There is clear difference density
    where the side chain is supposed to go
    (this is another clear sign that our MR solution was successful).
    Click on the <code>Simple Mutate</code> button in the refinement toolbar
    then click on an atom of Met139.
    A list of residue types should appear.
    Click on <code>MET</code> and the side chain will be completed
    (although not in the right conformation).
  </p>

  <h6 id="4.5">4.5. Rotamers</h6>
  <p>
    Now we need to move the side chain into the correct conformation.
    Click the <code>Rotamers</code> button in the refinement toolbar
    and then click on of the atoms in Met139.
    A list of rotamers for that residue type appears.
    A rotamer is simply a commonly observed side chain conformation
    and this list is ordered from most to least common.
  </p>
  <img src="img/rotamers.png" alt="Rotamers">
  <p>
    Use <code>.</code> and <code>,</code> on the keyboard
    to cycle through the rotamers.
    This can be done while adjusting the view in the main window.
    Each rotamer has a name that roughly describes the chi angles:
    p for 60, m for -60, t for 180
    and a number for the final angle of sp2 side chains.
    The closest rotamer for Met139 is mmt.
    Select this and click <code>OK</code>.
    Press <code>x</code> to perform real space refinement on this rotamer,
    which moves it into the density
    (as long as the residue is at the centre of the view).
    If this doesn't work you first need to click
    <code>Extensions / Settings / Install Template Keybindings</code>.
  </p>
  <p>
    There is also an <code>Auto Fit Rotamer</code> button
    that will try to pick the closest rotamer and then refine it automatically.
    Click this and then an atom of Met139 to try it out.
    The keyboard shortcut for this is <code>j</code>,
    which auto-fits the rotamer at the centre of the screen.
    There is another useful button on the refinement toolbar
    that automates everything we did in the last two sections.
    Go to Met164, click <code>Mutate & Auto Fit</code>,
    then click an atom from the residue and select MET from the list.
  </p>

  <h6 id="4.6">4.6. Real Space Refinement</h6>
  <p>
    The aim of real space refinement is to move the atoms
    so that two terms are minimised:
    one is how well the atoms fit the density
    and the other is how close bond lengths, angles, etc are to ideal values.
    Parts of the second term are known as restraints.
    At high resolution you can see individual atom positions
    so the density term is more important than the restraints term.
    At low resolution the density is not as detailed
    so the restraints term becomes more important.
    To adjust the weighting between the terms,
    select <code>Refine/Regularize Control</code>
    at the top of the refinement toolbar.
    You can change which restraints to use as well
    as the weight between the density and restraints terms.
    The default is <code>60</code>.
    Higher numbers will use the restraints less.
    Click the <code>Estimate</code> button,
    which will try to choose a sensible weight for the current map.
    The map that you are refining into can be changed
    with the <code>Select Map</code> button underneath.
  </p>
  <p>
    Go to Thr175. The red density at CG2 and strong green density opposite
    tell us that the side chain needs rotating.
    Instead of auto-fitting the rotamer we will attempt to refine it manually.
    Click the <code>Real Space Refine Zone</code> button
    on the refinement toolbar then click on Thr175 twice.
    You need to click twice because it expects a zone,
    i.e. you need to click the first and last residue
    in the range you want to refine.
    Some refinement traffic lights will appear.
  </p>
  <img src="img/refinement.png" alt="Refinement">
  <p>
    The numbers show
    how many standard deviations the restraints are from their ideal values.
    There is also a simple traffic light system from green to red.
    The fit to density can be assessed by eye.
    An initial minimisation has been done
    and the result is shown as a white copy of the atoms.
    They haven't moved much as the conformation is at a local minimum.
    Click the OG1 atom, drag it in the direction of the green density
    and let go to force it in that direction.
    The further you drag the more force you add
    so often you will need to drag past the point
    where you want the atom to end up.
    Once the residue is rotated into the right place click <code>Accept</code>.
  </p>
  <p>
    The shortcut we used earlier for refinement was <code>x</code>,
    which refines the residue at the centre of the view
    and automatically accepts the initial minimisation.
    If you want to drag the atoms or look at the refinement traffic lights
    you can use the <code>r</code> key instead.
    It is usually preferable to include the residues either side
    when refining so the backbone geometry does not become distorted.
    This is known as triple refine or neighbours refine.
    The shortcut for this is <code>t</code> (without auto-accept)
    or <code>h</code> (with auto-accept).
  </p>
  <p>
    A powerful combination of shortcuts is <code>hjh</code>,
    which can correct most side chain errors.
    It does neighbours refine to minimise the backbone geometry,
    auto-fits the rotamer
    (which should be easier with the updated backbone positions)
    and finally another neighbours refine
    to remove any backbone distortions introduced during the rotamer fitting.
    Press <code>space</code> to go to Glu176
    and then <code>hjh</code> to fix the rotamer.
  </p>

  <h6 id="4.7">4.7. Alternate conformations</h6>
  <p>
    Press <code>space</code> to go to Glu177.
    There is clear positive difference density
    suggesting the side chain should be in another conformation.
    There is also some negative difference density at the current position
    but auto-fitting puts the rotamer back in the same place.
    In this case the side chain could exist in two conformations in the crystal
    and the negative difference density
    is because we have one side chain at 100% occupancy.
    Press the <code>Add Alt Conf</code> button on the refinement toolbar.
    The following window should appear:
  </p>
  <img src="img/alt_conf_mode.png" alt="Alternate Conformation Mode">
  <p>
    This lets you choose whether to split the whole residue
    or just the atoms from C-alpha onwards.
    Splitting the whole residue
    will allow for any slight changes in backbone conformation.
    Now click on an atom in Glu177 and another window will appear:
  </p>
  <img src="img/alt_conf_rotamer.png" alt="Alternate Conformation Rotamer">
  <p>
    This lets you select an initial rotamer for the new conformation
    as well as what occupancy you want it to have.
    In this case we will leave the occupancy at 50%.
    After doing global refinement with REFMAC
    you may notice difference density
    that suggests the occupancy should be different.
    Look through the rotamers with <code>.</code> and <code>,</code>,
    select the one you think is closest and click <code>OK</code>.
    Perform a neighbours refine (<code>h</code> or <code>t</code>)
    to clean up the positions of both conformations.
  </p>

  <h6 id="4.8">4.8. Adding Terminal Residues</h6>
  <p>
    Between Tyr337 and Pro350 there is a missing loop
    with the sequence <code>DHSPPGKSGPEA</code>.
    However, we have enough density to build some of the residues.
    Go to Tyr337,
    click <code>Add Terminal Residue</code> on the refinement toolbar
    and click on an atom of Tyr337.
    This will build an alanine as the next residue.
    Press <code>h</code> to refine it and then mutate it to aspartic acid.
    Go to Pro350 and do the same for the other end of the loop.
    The backbone is quite clear for Ala349 and Glu348.
    There is some density for Pro347
    but you might want to wait until doing more refinement
    to get an improved map.
  </p>

  <h6 id="4.9">4.9. Peptide bonds</h6>
  <p>
    There is a problem with the peptide bond between Glu279 and Pro280.
    You will see there is negative difference density at the carbonyl oxygen
    but positive difference density opposite.
    This is a sign that the peptide needs to be flipped.
    Usually, this can be fixed by clicking on
    the <code>Flip Peptide</code> button on the refinement toolbar
    and clicking the peptide.
    The shortcut <code>q</code> flips the peptide at the centre of the view
    and <code>hqh</code> is another useful key combination.
    However, in this case there is an extra complication.
    Flipping the peptide will flip both the carbonyl and the nitrogen
    and still form a trans-peptide.
    If you try to refine this you will end up with a twisted peptide
    where the omega angle is &gt; 30&deg; and &lt; 150&deg;.
    This is indicated by a yellow shaded area.
  </p>
  <div class="row">
    <div class="one-half column"><img src="img/peptide_start.png" alt="Starting Peptide"></div>
    <div class="one-half column"><img src="img/peptide_twisted.png" alt="Twisted Peptide"></div>
  </div>
  <p>
    This example should be a cis-peptide instead.
    Click the <code>Edit Backbone Torsions</code> button
    on the refinement toolbar and then click an atom of the peptide.
    This allows you to rotate either the whole peptide
    or just the carbonyl using sliders.
    A Ramachandran plot for the residues either side gets updated as you rotate.
    One of the residues starts in the white disallowed region of the plot,
    which also suggests something could be wrong.
  </p>
  <div class="row">
    <div class="one-half column"><img src="img/backbone_rama.png" alt="Backbone Ramachandran Plot"></div>
    <div class="one-half column"><img src="img/backbone_sliders.png" alt="Edit Backbone"></div>
  </div>
  <p>
    Use the slider to rotate the carbonyl into the middle of the green density
    and click okay.
    You should hopefully see a green shaded area to indicate that
    it is a now a cis-peptide bond as the omega angle is less than 30&deg;.
    This is important because
    if there is a yellow shaded area for a twisted peptide
    then trans-peptide restraints will be used.
    These can be temporarily turned off
    from <code>Refine/Regularize Control</code>
    if you are struggling to force the backbone into the correct conformation,
    but in general these should be kept on
    to avoid building incorrect cis-peptides.
    Cis-peptides are only common for X-Pro bonds.
    If the second residue is something other than proline
    then a red shaded area will be shown to indicate a possible error.
    The figure below shows the correct conformation.
  </p>
  <img src="img/peptide_correct.png" alt="Correct Peptide">

  <h3 id="5">5. Building a peptide</h3>
  <p>
    Building the small peptide.
    The sequence is <code>SKSKDRKYTL</code> but one is modified.
    Use skeleton map to help visualise where the C-alphas are.
    Can see clear one in the middle of the blob.
    Start from a position of a C-alpha one away from the end.
    Then you will see an arrow 3.8A in length to place the first C-alpha
    at the end of the chain.
    From this first C-alpha you will place a baton back at the place
    you came from.
    Then place batons to the other end of the peptide.
    Click dismiss when done.
    Convert to a C-alpha trace.
    Will get a backwards and forwards trace.
    One should fit better than the other.
    Real space refine zone.
    Mutate residue range.
    Change to modified residue.
  </p>

  <h3 id="6">6. Adding solvent</h3>
  <ol>
    <li>Adding solvent molecules</li>
    <li>Auto find waters</li>
    <li>Checking waters</li>
    <li>Manually add waters</li>
  </ol>

  <h3 id="7">7. Adding a ligand</h3>
  <ol>
    <li>Only if Rob isn't doing this part</li>
  </ol>

  <p>
    Extra?
    Opening Coot via i2? Competition to see who gets the lowest R-free?
    Trying other online tutorials?
    Build whole peptide?
  </p>
  <p>
      Sequence from Gly117 to Gln364:
    </p>
    <pre><code>117 GVCWIYYPDGGSLVGEVNEDGEMTGEKIAYVYPDERTALYGKFIDGEMIEGKLATLMSTE
  177 EGRPHFELMPGNSVYHFDKSTSSCISTNALLPDPYESERVYVAESLISSAGEGLFSKVAV
  237 GPNTVMSFYNGVRITHQEVDSRDWALNGATLSLDEETVIDVPEPYNHVSKYCASLGHKAN
  297 HSFTPNCIYDMFVHPRFGPIKCIRTLRAVEADEELTVAYGYDHSPPGKSGPEAPEWYQVE
  357 LKAFQATQ</code></pre>
  

  <p>
    Other resources:
    Coot manual
    Coot tutorials.
  </p>

  <hr>
  <p>
    Paul Bond,
    University of York,
    <a href="mailto:paul.bond@york.ac.uk">paul.bond@york.ac.uk</a>
  </p>
</div>
